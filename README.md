# SPL_video_stimulation_PSD_analysis
This code provides some diagnostics for Skin Potential Level (SPL) signals. It uses a median-Welch PSD and filters artifacts to map signal energy across key frequency bands (f95/f99) and quantifies power-line noise. The results guide decisions on analysis bandwidth, mains filtering, and safe downsampling targets.

Skin Potential Level (SPL) is a voltage difference you can record from the skin surface (millivolt-scale). 
The signal is generated by the skin's inherent electrical activity, the driver of which is the sympathetic nervous system. 
It controls eccrine sweat glands, and as the activity rises, sweat ducts fill with electrolytes and the voltage shifts. Unlike exosomatic EDA measurement methods, the external current is not applied in this case. It is a fully passive measurement and requires amplification.

The code runs a median-Welch PSD on the SPL data from the experiment, using SPL measurements during the experiment (participants watching movie clips, designed to evoke negative emotions). 
Random spikes and artefacts are filtered out using the median across many windows, providing a stable and reliable picture of the underlying signal. 
The PSD tells us where the energy sits and whether power-line impact is present.
The code reports band percentages (0–0.05, 0.05–0.5, 2–5 Hz), f95/f99 within 0–5 Hz, and 50/60 Hz (± harmonics) strength as dBc/Hz vs the phasic median.
The main purpose of the code is to help in the diagnostics of: 
 a) The analysis bandwidth, which bands to  keep and what to ignore.
 b) Whether mains control is needed in QA (and how serious it is).
 c) Safe downsampling targets and anti-alias requirements ( that are set in the next step).


